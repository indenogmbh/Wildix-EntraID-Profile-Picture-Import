# Wildix EntraID Profile Picture Importer

This repository provides a comprehensive solution for importing user profile pictures from Entra ID (Azure AD) into Wildix telephony systems. The solution consists of two PowerShell scripts that automate the process of retrieving profile images, securely storing them in Azure Storage, and matching them to Wildix users.

## Disclaimer

This script is provided "as-is" without any warranties or guarantees of any kind. Use it at your own risk. We are not responsible for any damages, data loss, or other issues that may arise from the use of this script. Always test in a development environment before using it in production.

## Scripts Overview

### 1. `EntraID_ProfileImage_Retriever.ps1`

- **Description:**  
  This PowerShell script retrieves user profile pictures from Entra ID (Azure AD) and stores them in an Azure Storage account. It also generates a CSV file containing the email attributes of users, which will be used for matching with Wildix user data in the next step.

- **Key Features:**
  - Authenticates with Entra ID (Azure AD) to retrieve user profile pictures.
  - Stores images directly in an Azure Storage Blob container.
  - Generates a CSV file containing user emails and image URLs for further matching.
  - Secures the Blob container by generating a SAS token for controlled access.
  - Ensures that the profile picture files are temporarily stored on the local machine before being uploaded to Azure Blob Storage.
  - Provides console output for progress tracking (no pop-up dialogs).
  - Handles errors gracefully, ensuring that the script stops if authentication fails.

### 2. `Wildix_User_Matcher.ps1`

- **Description:**  
  This PowerShell script matches the CSV file generated by the `EntraID_ProfileImage_Retriever.ps1` script with the exported Wildix user data. It ensures that the correct profile pictures are assigned to the corresponding users in the Wildix system by updating the `ImageURL` column in the Wildix user export file.

- **Key Features:**
  - Prompts the user for the paths to the source (Entra ID profile image CSV) and target (Wildix user export CSV) files.
  - Matches the Entra ID profile image CSV with Wildix user export data using the email attribute.
  - Updates the `ImageURL` column in the Wildix user export CSV with the correct profile picture URLs.
  - Saves the updated Wildix user export file to a specified location.

### Prerequisites

- **Azure Storage Account:**  
  You need an Azure Storage Account where the profile pictures will be stored. **For security reasons, ensure that the storage account is not configured to allow anonymous access.** The storage account should require authentication to access the stored data. Ensure you have the necessary access to create Blob containers and generate SAS tokens.
  
- **Wildix System Access:**  
  Ensure that you have access to the Wildix system for exporting and importing user data. You will need to export the user data as a CSV file for matching.
  
- **Entra ID (Azure AD) Access:**  
  Appropriate permissions are required to retrieve user profile pictures from Entra ID (Azure AD). This typically includes `User.Read.All` and `ProfilePhoto.Read` permissions.

### Step-by-Step Instructions

1. **Clone the Repository:**

   ```bash
   git clone https://github.com/yourusername/Wildix-EntraID-Profile-Picture-Importer.git
   cd Wildix-EntraID-Profile-Picture-Importer

   
### Hinweise:
- Der Codeblock für die Powershell-Befehle und die Bash-Befehle wurde korrekt im Markdown-Format eingebettet.
- Der Haftungsausschluss wurde im Abschnitt "Disclaimer" hinzugefügt, um klarzustellen, dass die Nutzung des Skripts auf eigene Gefahr erfolgt.
- Der Copyright-Hinweis wurde am Ende der Datei ergänzt.

Diese Datei kannst du nun direkt in dein `readme.md`-Dokument einfügen und in deinem Repository verwenden. Wenn du noch weitere Änderungen benötigst, lass es mich wissen!

